name: bots-sweep-bot
on:
  issues:
    types: [opened, labeled]
permissions:
  contents: write
  pull-requests: write
  issues: write
concurrency:
  group: bots-sweep-bot-${{ github.ref }}
  cancel-in-progress: true
jobs:
  sweep:
    runs-on: ubuntu-latest
    if: contains(github.event.issue.labels.*.name, 'sweep')
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Sweep Bot
        uses: sweep-ai/sweep-action@v1
        env:
          SWEEP_API_KEY: ${{ secrets.SWEEP_API_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          SWEEP_CONFIG: |
            {
              "max_files": 100,
              "max_lines": 2000,
              "auto_merge": false,
              "create_pr": true,
              "pr_title_template": "ðŸ¤– Sweep: {{issue_title}}",
              "pr_body_template": "## ðŸ¤– AI-Generated Fix\n\nThis PR was automatically generated by Sweep to address issue #{{issue_number}}.\n\n### Changes:\n- {{changes_summary}}\n\n### Testing:\n- [ ] Manual testing required\n- [ ] Code review required\n\n---\n*Generated by Sweep AI*"
            }